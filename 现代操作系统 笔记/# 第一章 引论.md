# 第一章 引论

## 习题解答

### 1.操作系统的两大主要作用是什么？

1）通过资源管理，提高系统的使用效率。
2）改善人机界面，向用户提供友好的工作环境。

### 2.在1.4节中描述了9种不同类型的操作系统，列举每个操作系统的应用（每种系统一种应用）

1）大型机操作系统：大型保险公司的索赔流程处理系统
2）服务器操作系统：siri所提供的语音文本转换服务
3）多处理器操作系统：视频剪辑与渲染
4）个人计算机操作系统：文字处理应用
5）掌上计算机操作系统：上下文感知推荐系统
6）嵌入式操作系统：微波炉、电视机、汽车、DVD刻录机
7）传感器节点操作系统：野外温度监测
8）实时操作系统：航空管制系统
9）智能卡操作系统：电子支付

### 3.分时系统和多道程序系统的区别是什么？

分时系统是让多个进程轮流占用处理机，每个进程不管是否结束，在一个时间片内都会强制停止，换下一进程

多道程序系统是系统分配多个进程同时运行占用处理机，直到进程结束。

### 4.为了使用高速缓存，主存被划分为若干cache行，通常每行长32或64字节。每次缓存一整个cache行。每次缓存一整行而不是一个字节或一个字，这样做的优点是什么？

经验证据表明，存储器访问表现出引用局部原则，即如果读取某一位置，则接下来访问这个位置的概率非常高，尤其是紧随其后的内存位置。因此，通过缓存整个缓存行，接下来缓存命中的概率会增加。此外，现代的硬件可以将32或64字节块整个传输到高速缓存行，比单个字节读取，总共32或64字节的速度要快得多。

### 5.在早期计算机中，每个字节的读写直接由CPU处理（即没有DMA）。对于多道程序而言这种组织方式有什么含义？

DMA（Direc Memory Access）：直接存储器访问。
多道程序设计的主要原因是在某个程序等待I/O完成时，可以让CPU做一些其他操作。如果没有DMA，则CPU完全占用I/O，因此通过多道程序设计没有任何收益增加获得（至少在CPU利用率方面）。无论程序执行多少I/O，CPU都将100%处于忙碌。这当然假设主要的延迟时数据被复制时的等待。如果由于其他原因（例如，到达串行线路）I/O很慢，CPU可以执行其他工作。

### 6.与访问I/O设备相关的指令通常是特权指令，也就是说，它们能在内核态执行而在用户态则不行。说明为什么这些指令是特权指令。

对访问I/O设备的用户的权限根据用户的区别有不同的限制。（以打印机为例）一些用户可以随意打印，没有页数限制。一些用户不允许打印。一些用户只能打印一定数量。这个限制是由系统管理员基于一些政策设立的。这些政策需要强制执行，这样用户级的程序就不会干扰他们。

### 7.系列计算机的思想在20世纪60年代由IBM引入System/360大型机。现在这种思想已经消亡了还是继续活跃着？

继续活跃着。例如，英特尔制造的酷睿i3，i5和i7的CPU具有各种不同的属性，包括速度和功率消耗等。所有这些机器在架构上都是兼容的，他们只是在价格和性能上有所区别。

### 8.缓慢采用GUI的一个原因是支持它的硬件的成本（高昂）。为了支持25行80列字符的单色文本屏幕，需要多少视频RAM？对于1024*768像素24位色彩位图需要多少视频RAM？在1980年（每KB5美元），这些RAM的成本是多少？现在它的成本是多少？

1）25*80*1 = 2000字节
2）1024*768*3 = 2359296字节（一字节8位，24位就是三个字节）


### 9.在建立一个操作系统时有几个设计目的，例如资源利用、及时性、健壮性等。请列举两个可能互相矛盾的设计目的。

考虑公平性和实时性。公平性要求每个过程都能以公平的方式分配其资源，没有任何过程能得到超过其公平的份额。另一方面，实时性要求根据不同进程必须完成其执行的时间来分配资源。一个实时性系统可能会得到不成比例的资源共享。

### 10.内核态和用户态有哪些区别？解释在设计操作系统时存在两种不同模式有什么帮助。

大多数现代CPU提供两种执行模式：内核态和用户态。 CPU可以执行其指令集中的每条指令，并在内核态下执行时使用硬件的各种功能。 但是用户态只能执行部分指令，执行时仅使用部分功能。 拥有两种模式允许设计人员以用户态运行用户程序，从而拒绝他们访问关键指令。

### 11.一个255GB大小的磁盘有65536个柱面，每个磁道有255个扇区，每个扇区有512个字节。这个磁盘有多少盘片和磁头？假设平均寻道时间为11ms，平均旋转延迟为7ms，读取速率为100MB/s，计算从一个扇区读取400KB需要的平均时间。

### 12.下面的哪一条指令只能在内核态使用？（a）禁止所有的中断 （b）读日期-时间时钟 （c）设置日期-时间时钟 （d）改变存储器映像。

a,c,d

### 13.考虑一个有两个CPU的系统，并且每一个CPU有两个线程（超线程）。假设有三个程序P0、P1、P2，分别以运行时间5ms、10ms、20ms开始。运行这些程序需要多少时间？假设这三个程序都是100%受限于CPU，在运行时无阻塞，并且一旦设定就不改变CPU。

20、25、30、35ms


### 14.一台计算机有一个四级流水线，每一级都花费相同的时间执行其工作，即1ns。这台机器每秒可执行多少条指令？



### 15.假设一个计算机系统有高速缓存、内存（RAM）以及磁盘，操作系统用虚拟内存。读取缓存中的一个词需要1ns，RAM需要10ns，磁盘需要10ms。如果缓存的命中率是95%，内存的是99%（缓存失效时），读取一个词的平均时间是多少？

### 16.在用户程序进行一个系统调用，以读写磁盘文件时，该程序提供指示说明了所需要的文件、一个指向数据缓冲区的指针以及计数。然后，控制权转给操作系统，它调用相关的驱动程序。假设驱动程序启动磁盘并且直到中断发生才终止。在从磁盘读的情况下，很明显，调用者会被阻塞（因为文件中没有数据）。在向磁盘写时会发生什么情况？需要把调用者阻塞一直等到磁盘传送完成为止吗？

### 17.什么是陷阱指令？在操作系统中解释它的用途。

陷阱指令将一个处理器的执行模式从用户模式切换到内核模式。该指令允许用户程序调用操作系统内核中的函数。

### 18.在分时系统中为什么需要进程表？在只有一个进程存在的个人计算机系统中，该进程控制整个机器直到进程结束，这种机器也需要进程表吗？

进程表是为了存储当前被挂起或是被延迟和阻塞的进程状态。在单一进程的系统中不需要，因为单一进程从不挂起。

### 19.说明有没有理由在一个非空的目录中安装一个文件系统。如果要这样做，如何做？

### 20.对于下列系统调用，给出引起失败的条件：fork、exec以及unlink

### 21.下列资源能使用哪种多路复用（时间、空间或者两者皆可）：CPU、内存，磁盘，网卡，打印机，键盘以及显示器？

### 22.在 count=write(fd,buffer,nbytes);调用中，是否能将函数返回值传递给count变量而不是nbytes变量？如果能，为什么？

### 23.有一个文件，其文件描述符是fd，内含下列字节序列：3，1，4，1，5，9，2，6，5，3，5.有如下系统调用：
### lseek(fd,3,SEEK_SET)
### read(fd,&buffer,4);
### 其中lseek调用寻找文件中的字节3。在读操作完成之后，buffer中的内容是什么？

### 24.假设一个10MB的文件保存在磁盘同一磁道（磁道号为50）的连续扇区中。磁盘的磁臂此时位于第100号磁道。要想从磁盘上找回这个文件，需要多长时间？假设磁臂从一个柱面移动到下一个柱面需要1ms，保存文件的开始部分的扇区旋转到磁头下需要5ms，并且读速率是200MB/s

### 25.块特殊文件和字符特殊文件的基本差别是什么？

块特殊文件包含被编号的块，每一块都可以独立地读取或者写入。而且可以定位于任何块，并且开始读出或写入。这些对于字符特殊文件是不可能的。

### 26.在图1-17的例子中库调用称为read，而系统调用自身称为read。这两者都有相同的名字是正常的吗？如果不是，哪一个更重要？

### 27.现代操作系统将进程的地址空间从机器物理内存中分离出来。列举这种设计的两个好处。

### 28.对程序员而言，系统调用就像对其他库过程的调用一样。有无必要让程序员了解哪一个库过程导致了系统调用？在什么情形下，为什么？

### 29.图1-23说明有一批UNIX的系统调用没有与之等价的Win32 API。对于所列出的每一个没有Win32等价的调用，若程序员要把一个UNIX程序转换到Windows下运行，会有什么后果？

### 30.可移植的操作系统是从一个系统体系结构移动到另一个系统体系结构而不需要任何修改的操作系统。请解释为什么建立一个完全可移植性的操作系统是不可行的。描述一下在设计一个高度可移植的操作系统时你设计的两个高级层是什么样的。

### 31.请解释在建立基于微内核的操作系统时策略与机制分离带来的好处。

### 32.虚拟机由于很多因素而十分流行，然而它们也有一些缺点，给出一个缺点。

### 33.单位转换的练习：（a）一微年是多少秒？（b）微米常称为micron。那么meigamicron是多长？（c）1PB存储器中有多少字节？（d）地球的质量是6000 yottagram，换算成kilogram是多少？

### 34.写一个和图1-19类似的shell，但是包含足够的实际可工作的代码，这样可以测试它。还可以添加某些功能，如输入输出重定向、管道以及后台作业等。

### 35.如果你有一个个人UNIX类操作系统（Linux、MINIX/3、FreeBSD等），可以安全地崩溃和再启动，请写一个试图创建无限制数量子进程的shell脚本并观察所发生的事。在运行实验之前，通过shell键入sync，在磁盘上备好文件缓冲区以避免毁坏文件系统。注意：在没有得到系统管理员额允许之前，不要在分时系统上进行这一尝试。其后果将会立即出现，尝试者可能会被抓住并受到惩罚。

### 36.用一个类似于UNIX od 的工具考察并尝试解释UNIX类系统或Windows 的目录。提示：如何进行取决于OS允许做什么。一个有益的技巧是在软盘上创建一个目录，其中包含一个操作系统，然后使用另一个允许进行此类访问的不同的操作系统读取盘上的原始数据。